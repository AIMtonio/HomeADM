-- SP EDOCTAV2CREADIREC
DELIMITER ;
DROP PROCEDURE IF EXISTS EDOCTAV2CREADIREC;
DELIMITER $$

CREATE PROCEDURE `EDOCTAV2CREADIREC`(	)
BEGIN

(SELECT DISTINCT CONVERT(CONCAT('mkdir -p -m a=rwx ', RutaExpArchivos, TRIM(PrefijoEmpresa),'/', MesProceso,'/',RIGHT(CONCAT('000',CAST(SucursalID AS CHAR)) , 3)), CHAR)    AS cmd
 FROM EDOCTAV2DATOSCTE,EDOCTAV2PARAMS WHERE MesProceso=AnioMes)
UNION
(SELECT DISTINCT CONVERT(CONCAT('mkdir -p -m a=rwx ', RutaExpArchivos,'CBB/', TRIM(PrefijoEmpresa),'/', MesProceso,'/',RIGHT(CONCAT('000',CAST(SucursalID AS CHAR)) , 3)), CHAR)    AS cmd
 FROM EDOCTAV2DATOSCTE,EDOCTAV2PARAMS WHERE MesProceso=AnioMes)
UNION
(SELECT DISTINCT CONVERT(CONCAT('mkdir -p -m a=rwx ', RutaExpArchivos,'XML/', TRIM(PrefijoEmpresa),'/', MesProceso,'/',RIGHT(CONCAT('000',CAST(SucursalID AS CHAR)) , 3)), CHAR)    AS cmd
 FROM EDOCTAV2DATOSCTE,EDOCTAV2PARAMS WHERE MesProceso=AnioMes)
UNION
(SELECT DISTINCT CONVERT(CONCAT('mkdir -p -m a=rwx ', RutaExpArchivos,'TXT/', TRIM(PrefijoEmpresa),'/', MesProceso,'/',RIGHT(CONCAT('000',CAST(SucursalID AS CHAR)) , 3)), CHAR)    AS cmd
 FROM EDOCTAV2DATOSCTE,EDOCTAV2PARAMS WHERE MesProceso=AnioMes);

END$$
